# å‰ç«¯APIåŠ è§£å¯†åŠŸèƒ½ä½¿ç”¨è¯´æ˜

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

æœ¬é¡¹ç›®å®ç°äº†å‰ç«¯APIè¯·æ±‚å’Œå“åº”æ•°æ®çš„åŠ è§£å¯†åŠŸèƒ½ï¼Œä»¥æé«˜æ•°æ®ä¼ è¾“çš„å®‰å…¨æ€§ã€‚ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š

1. **æ•°æ®åŠ å¯†**ï¼šå¯¹å‘é€åˆ°åç«¯çš„æ•æ„Ÿæ•°æ®è¿›è¡ŒåŠ å¯†
2. **æ•°æ®è§£å¯†**ï¼šå¯¹æ¥æ”¶åˆ°çš„åŠ å¯†å“åº”æ•°æ®è¿›è¡Œè§£å¯†
3. **å“ˆå¸Œè®¡ç®—**ï¼šæä¾›SHA256å’ŒMD5å“ˆå¸Œç®—æ³•
4. **å¯†é’¥ç®¡ç†**ï¼šæ”¯æŒé…ç½®ä¸åŒçš„åŠ å¯†ç®—æ³•å’Œå¯†é’¥

## ğŸ› ï¸ æ ¸å¿ƒç»„ä»¶

### 1. åŠ å¯†å·¥å…·ç±» (`src/utils/crypto.ts`)

æä¾›åŸºç¡€çš„åŠ è§£å¯†å’Œå“ˆå¸ŒåŠŸèƒ½ï¼š

```typescript
import { encryptData, decryptData, hashSHA256, hashMD5 } from '@/utils/crypto';

// åŠ å¯†æ•°æ®
const encrypted = encryptData({ username: 'user', password: 'pass' });

// è§£å¯†æ•°æ®
const decrypted = decryptData(encrypted);

// å“ˆå¸Œè®¡ç®—
const sha256Hash = hashSHA256('data');
const md5Hash = hashMD5('data');
```

### 2. åŠ å¯†Hook (`src/composables/useCrypto.ts`)

æä¾›å“åº”å¼çš„åŠ è§£å¯†åŠŸèƒ½ï¼š

```typescript
import { useCrypto } from '@/composables/useCrypto';

const { encrypt, decrypt, sha256, md5, isEncrypting, isDecrypting, error } = useCrypto();

// ä½¿ç”¨ç¤ºä¾‹
const handleEncrypt = async () => {
  try {
    const encrypted = await encrypt({ sensitive: 'data' });
    console.log('åŠ å¯†ç»“æœ:', encrypted);
  } catch (err) {
    console.error('åŠ å¯†å¤±è´¥:', err);
  }
};
```

### 3. HTTPå®¢æˆ·ç«¯é›†æˆ (`src/api/http.ts`)

è‡ªåŠ¨å¤„ç†APIè¯·æ±‚å’Œå“åº”çš„åŠ è§£å¯†ï¼š

```typescript
// è¯·æ±‚ä¼šè‡ªåŠ¨æ ¹æ®é…ç½®è¿›è¡ŒåŠ å¯†/è§£å¯†
const config = {
  encryptionConfig: {
    enableEncryption: true,
    encryptRequest: true,
    decryptResponse: true,
  },
};

http.post('/api/login', { username, password }, config);
```

## âš™ï¸ é…ç½®é€‰é¡¹

### ç¯å¢ƒå˜é‡é…ç½®

åœ¨ `.env` æ–‡ä»¶ä¸­é…ç½®åŠ å¯†é€‰é¡¹ï¼š

```env
# å¯ç”¨åŠ å¯†åŠŸèƒ½
VITE_ENABLE_ENCRYPTION=true

# åŠ å¯†ç®—æ³• (AES, DES, Rabbit, RC4)
VITE_CRYPTO_ALGORITHM=AES

# åŠ å¯†å¯†é’¥
VITE_CRYPTO_SECRET_KEY=your-secret-key-here
```

### è¿è¡Œæ—¶é…ç½®

```typescript
// è‡ªå®šä¹‰åŠ å¯†é…ç½®
const customConfig = {
  enableEncryption: true,
  algorithm: 'AES' as const,
  secretKey: 'custom-key',
  encryptRequest: true,
  decryptResponse: true,
};

const encrypted = encryptData(data, customConfig);
```

## ğŸ“– ä½¿ç”¨ç¤ºä¾‹

### 1. åŸºç¡€åŠ è§£å¯†

```typescript
import { encryptData, decryptData } from '@/utils/crypto';

// åŠ å¯†å¯¹è±¡
const userData = { username: 'john', password: 'secret123' };
const encrypted = encryptData(userData);

// è§£å¯†æ•°æ®
const decrypted = decryptData(encrypted);
console.log(decrypted); // { username: 'john', password: 'secret123' }
```

### 2. APIè°ƒç”¨ä¸­ä½¿ç”¨åŠ å¯†

```typescript
// src/api/user.ts
import http from './http';

interface LoginRequest {
  username: string;
  password: string;
}

export function login(data: LoginRequest) {
  const config = {
    encryptionConfig: {
      enableEncryption: true,
      encryptRequest: true,
      decryptResponse: true,
    },
  };

  return http.post('/auth/login', data, config as any);
}
```

### 3. åœ¨Vueç»„ä»¶ä¸­ä½¿ç”¨

```vue
<template>
  <div>
    <el-input v-model="inputData" placeholder="è¾“å…¥è¦åŠ å¯†çš„æ•°æ®" />
    <el-button @click="handleEncrypt" :loading="isEncrypting">åŠ å¯†</el-button>
    <div v-if="encryptedData">{{ encryptedData }}</div>
  </div>
</template>

<script setup lang="ts">
  import { ref } from 'vue';
  import { useCrypto } from '@/composables/useCrypto';

  const inputData = ref('');
  const encryptedData = ref('');

  const { encrypt, isEncrypting, error } = useCrypto();

  const handleEncrypt = async () => {
    try {
      encryptedData.value = await encrypt(inputData.value);
    } catch (err) {
      console.error('åŠ å¯†å¤±è´¥:', error.value);
    }
  };
</script>
```

## ğŸ”’ å®‰å…¨å»ºè®®

1. **å¯†é’¥ç®¡ç†**ï¼š
   - ä¸è¦åœ¨ä»£ç ä¸­ç¡¬ç¼–ç å¯†é’¥
   - ä½¿ç”¨ç¯å¢ƒå˜é‡å­˜å‚¨å¯†é’¥
   - å®šæœŸè½®æ¢å¯†é’¥

2. **ç®—æ³•é€‰æ‹©**ï¼š
   - å¯¹äºå¤§é‡æ•°æ®ï¼Œæ¨èä½¿ç”¨AES
   - å¯¹äºå¯†é’¥ç­‰å°æ•°æ®ï¼Œå¯è€ƒè™‘RSA

3. **ä¼ è¾“å®‰å…¨**ï¼š
   - å§‹ç»ˆé…åˆHTTPSä½¿ç”¨
   - æ•æ„Ÿæ“ä½œå»ºè®®äºŒæ¬¡éªŒè¯

## ğŸ§ª æµ‹è¯•éªŒè¯

é¡¹ç›®åŒ…å«æµ‹è¯•æ–‡ä»¶ `src/utils/test-crypto.ts`ï¼Œå¯ä»¥éªŒè¯åŠ è§£å¯†åŠŸèƒ½çš„æ­£ç¡®æ€§ï¼š

```bash
# è¿è¡Œæµ‹è¯•
npm run dev
# ç„¶ååœ¨æµè§ˆå™¨æ§åˆ¶å°æŸ¥çœ‹æµ‹è¯•è¾“å‡º
```

## ğŸ“ æ–‡ä»¶ç»“æ„

```
src/
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ crypto.ts          # åŠ å¯†å·¥å…·ç±»
â”‚   â””â”€â”€ test-crypto.ts     # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ composables/
â”‚   â””â”€â”€ useCrypto.ts       # åŠ å¯†Hook
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ http.ts            # HTTPå®¢æˆ·ç«¯ï¼ˆå·²é›†æˆåŠ å¯†ï¼‰
â”‚   â””â”€â”€ crypto-demo.ts     # åŠ å¯†APIç¤ºä¾‹
â”œâ”€â”€ components/
â”‚   â””â”€â”€ business/
â”‚       â””â”€â”€ CryptoDemo.vue # åŠ å¯†æ¼”ç¤ºç»„ä»¶
â””â”€â”€ views/
    â””â”€â”€ CryptoDemoView.vue # åŠ å¯†æ¼”ç¤ºé¡µé¢
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

1. å®‰è£…ä¾èµ–ï¼š

```bash
npm install crypto-js @types/crypto-js
```

2. é…ç½®ç¯å¢ƒå˜é‡ï¼š

```env
VITE_ENABLE_ENCRYPTION=true
VITE_CRYPTO_ALGORITHM=AES
VITE_CRYPTO_SECRET_KEY=your-secret-key
```

3. åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ï¼š

```typescript
import { useCrypto } from '@/composables/useCrypto';

const { encrypt, decrypt } = useCrypto();
```

ç°åœ¨æ‚¨çš„å‰ç«¯åº”ç”¨å°±å…·å¤‡äº†å®Œæ•´çš„APIåŠ è§£å¯†åŠŸèƒ½ï¼
