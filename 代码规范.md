# Vue3 PCç«¯é¡¹ç›®ä»£ç è§„èŒƒ

## ğŸ“‹ é¡¹ç›®ç»“æ„è§„èŒƒ

```
src/
â”œâ”€â”€ api/                 # APIæ¥å£
â”‚   â”œâ”€â”€ modules/        # æ¨¡å—åŒ–API
â”‚   â””â”€â”€ index.ts        # APIç»Ÿä¸€å¯¼å‡º
â”œâ”€â”€ assets/             # é™æ€èµ„æº
â”‚   â”œâ”€â”€ icons/         # å›¾æ ‡
â”‚   â”œâ”€â”€ images/        # å›¾ç‰‡
â”‚   â””â”€â”€ styles/        # æ ·å¼æ–‡ä»¶
â”œâ”€â”€ components/         # å…¬å…±ç»„ä»¶
â”‚   â”œâ”€â”€ common/        # é€šç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ business/      # ä¸šåŠ¡ç»„ä»¶
â”‚   â””â”€â”€ base/          # åŸºç¡€UIç»„ä»¶
â”œâ”€â”€ composables/        # ç»„åˆå¼å‡½æ•°
â”œâ”€â”€ directives/         # è‡ªå®šä¹‰æŒ‡ä»¤
â”œâ”€â”€ hooks/              # è‡ªå®šä¹‰hooks
â”œâ”€â”€ layouts/            # å¸ƒå±€ç»„ä»¶
â”œâ”€â”€ plugins/            # æ’ä»¶
â”œâ”€â”€ router/             # è·¯ç”±é…ç½®
â”œâ”€â”€ store/              # çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ modules/       # æ¨¡å—åŒ–store
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ types/              # TypeScriptç±»å‹å®šä¹‰
â”œâ”€â”€ utils/              # å·¥å…·å‡½æ•°
â”œâ”€â”€ views/              # é¡µé¢ç»„ä»¶
â””â”€â”€ App.vue
â””â”€â”€ main.ts
```

## ğŸ¯ Vue 3 å¼€å‘è§„èŒƒ

### 1. ç»„ä»¶å¼€å‘è§„èŒƒ

```vue
<script setup lang="ts">
  // 1. å¯¼å…¥é¡ºåºè§„èŒƒ
  // Vueç›¸å…³
  import { ref, computed, watch, onMounted } from 'vue';
  import { useRouter } from 'vue-router';

  // ç¬¬ä¸‰æ–¹åº“
  import { message } from 'ant-design-vue';
  import { debounce } from 'lodash-es';

  // ç±»å‹å®šä¹‰
  import type { UserInfo } from '@/types/user';

  // API
  import { getUserList } from '@/api/user';

  // ç»„ä»¶
  import UserCard from './UserCard.vue';

  // å·¥å…·å‡½æ•°
  import { formatDate } from '@/utils/date';

  // 2. å®šä¹‰Propsï¼ˆä½¿ç”¨TypeScriptï¼‰
  interface Props {
    userId: number;
    title?: string;
    showAction?: boolean;
  }

  const props = withDefaults(defineProps<Props>(), {
    title: '',
    showAction: false,
  });

  // 3. å®šä¹‰Emits
  const emit = defineEmits<{
    (e: 'update:title', value: string): void;
    (e: 'success'): void;
    (e: 'error', error: Error): void;
  }>();

  // 4. å“åº”å¼æ•°æ®
  const loading = ref(false);
  const userList = ref<UserInfo[]>([]);
  const searchKey = ref('');

  // 5. è®¡ç®—å±æ€§
  const filteredList = computed(() => {
    return userList.value.filter((user) => user.name.includes(searchKey.value));
  });

  // 6. æ–¹æ³•å®šä¹‰
  const fetchData = async () => {
    try {
      loading.value = true;
      const { data } = await getUserList();
      userList.value = data;
    } catch (error) {
      message.error('è·å–æ•°æ®å¤±è´¥');
    } finally {
      loading.value = false;
    }
  };

  // 7. ç”Ÿå‘½å‘¨æœŸ
  onMounted(() => {
    fetchData();
  });

  // 8. ç›‘å¬å™¨
  watch(
    () => props.userId,
    (newVal) => {
      if (newVal) {
        fetchData();
      }
    },
    { immediate: true }
  );

  // 9. æš´éœ²ç»™çˆ¶ç»„ä»¶çš„æ–¹æ³•ï¼ˆå¦‚æœéœ€è¦ï¼‰
  defineExpose({
    refresh: fetchData,
  });
</script>

<template>
  <!-- ç»„ä»¶æ ¹å…ƒç´ æ·»åŠ ç±»å -->
  <div class="user-container">
    <!-- ä½¿ç”¨kebab-caseäº‹ä»¶ -->
    <UserCard :user="user" @click-card="handleCardClick" @delete="handleDelete" />

    <!-- æ¡ä»¶æ¸²æŸ“ -->
    <template v-if="loading">
      <Loading />
    </template>

    <!-- åˆ—è¡¨æ¸²æŸ“ä½¿ç”¨key -->
    <template v-else>
      <div v-for="user in filteredList" :key="user.id" class="user-item">
        {{ user.name }}
      </div>
    </template>

    <!-- æ’æ§½ -->
    <slot name="footer">
      <div class="default-footer">é»˜è®¤åº•éƒ¨å†…å®¹</div>
    </slot>
  </div>
</template>

<style scoped lang="scss">
  // ä½¿ç”¨scopedæ ·å¼
  .user-container {
    padding: 20px;

    .user-item {
      margin: 10px 0;
      padding: 10px;
      border: 1px solid #e4e7ed;

      &:hover {
        background-color: #f5f7fa;
      }
    }

    // BEMå‘½åè§„èŒƒï¼ˆå¯é€‰ï¼‰
    &--disabled {
      opacity: 0.6;
      pointer-events: none;
    }
  }

  // æ·±åº¦é€‰æ‹©å™¨
  :deep(.ant-btn) {
    min-width: 80px;
  }
</style>
```

### 2. ç»„åˆå¼å‡½æ•°è§„èŒƒ

```typescript
// composables/useUserList.ts
import { ref, computed } from 'vue';
import { getUserList, UserParams } from '@/api/user';
import type { UserInfo } from '@/types/user';

export function useUserList(params: UserParams) {
  // çŠ¶æ€
  const list = ref<UserInfo[]>([]);
  const loading = ref(false);
  const total = ref(0);
  const error = ref<Error | null>(null);

  // è®¡ç®—å±æ€§
  const isEmpty = computed(() => list.value.length === 0);

  // æ–¹æ³•
  const fetchList = async () => {
    try {
      loading.value = true;
      error.value = null;
      const { data, total: totalCount } = await getUserList(params);
      list.value = data;
      total.value = totalCount;
    } catch (err) {
      error.value = err as Error;
      throw err;
    } finally {
      loading.value = false;
    }
  };

  // é‡ç½®
  const reset = () => {
    list.value = [];
    total.value = 0;
  };

  return {
    // çŠ¶æ€
    list,
    loading,
    total,
    error,

    // è®¡ç®—å±æ€§
    isEmpty,

    // æ–¹æ³•
    fetchList,
    reset,
  };
}
```

### 3. TypeScriptç±»å‹å®šä¹‰è§„èŒƒ

```typescript
// types/user.ts

// 1. ä½¿ç”¨typeè¿˜æ˜¯interfaceï¼Ÿ
// - å¯¹è±¡ç±»å‹ä½¿ç”¨interface
// - è”åˆç±»å‹ã€äº¤å‰ç±»å‹ä½¿ç”¨type

// åŸºç¡€ç±»å‹
export interface UserBase {
  id: number;
  name: string;
  email: string;
}

// æ‰©å±•ç±»å‹
export interface UserInfo extends UserBase {
  avatar?: string;
  age: number;
  gender: GenderEnum;
  roles: Role[];
  createTime: string;
}

// æšä¸¾
export enum GenderEnum {
  MALE = 1,
  FEMALE = 2,
  UNKNOWN = 0,
}

// è¯·æ±‚å‚æ•°ç±»å‹
export interface UserParams {
  page?: number;
  size?: number;
  keyword?: string;
  status?: UserStatus;
}

// å“åº”æ•°æ®ç±»å‹
export interface UserListResponse {
  data: UserInfo[];
  total: number;
  page: number;
}

// å·¥å…·ç±»å‹
export type PartialUser = Partial<UserInfo>;
export type UserKeys = keyof UserInfo;
```

### 4. è·¯ç”±è§„èŒƒ

```typescript
// router/index.ts
import type { RouteRecordRaw } from 'vue-router';

const routes: RouteRecordRaw[] = [
  {
    path: '/',
    name: 'Layout', // ä½¿ç”¨å¤§é©¼å³°å‘½å
    component: () => import('@/layouts/MainLayout.vue'),
    redirect: '/dashboard',
    meta: {
      title: 'é¦–é¡µ',
      requiresAuth: true,
      keepAlive: true,
    },
    children: [
      {
        path: 'dashboard',
        name: 'Dashboard',
        component: () => import('@/views/dashboard/index.vue'),
        meta: {
          title: 'æ§åˆ¶å°',
          icon: 'dashboard',
        },
      },
      {
        path: 'user',
        name: 'UserManagement',
        component: () => import('@/views/user/index.vue'),
        meta: {
          title: 'ç”¨æˆ·ç®¡ç†',
          permissions: ['user:view'],
        },
        children: [
          {
            path: 'list',
            name: 'UserList',
            component: () => import('@/views/user/List.vue'),
          },
        ],
      },
    ],
  },
  {
    path: '/login',
    name: 'Login',
    component: () => import('@/views/login/index.vue'),
    meta: {
      title: 'ç™»å½•',
      noCache: true,
      hideInMenu: true,
    },
  },
  {
    path: '/:pathMatch(.*)*',
    name: 'NotFound',
    component: () => import('@/views/error/404.vue'),
  },
];
```

### 5. çŠ¶æ€ç®¡ç†è§„èŒƒï¼ˆPiniaï¼‰

```typescript
// store/modules/user.ts
import { defineStore } from 'pinia';
import type { UserInfo } from '@/types/user';
import { getUserInfo, updateUserInfo } from '@/api/user';

interface UserState {
  info: UserInfo | null;
  token: string;
  permissions: string[];
}

export const useUserStore = defineStore('user', {
  state: (): UserState => ({
    info: null,
    token: '',
    permissions: [],
  }),

  getters: {
    isLogin: (state) => !!state.token,
    userName: (state) => state.info?.name || '',
    // å¸¦å‚æ•°çš„è®¡ç®—å±æ€§
    hasPermission: (state) => (permission: string) => {
      return state.permissions.includes(permission);
    },
  },

  actions: {
    async getUserInfo() {
      try {
        const { data } = await getUserInfo();
        this.info = data;
        return data;
      } catch (error) {
        return Promise.reject(error);
      }
    },

    async updateInfo(payload: Partial<UserInfo>) {
      const { data } = await updateUserInfo(payload);
      if (this.info) {
        Object.assign(this.info, data);
      }
    },

    setToken(token: string) {
      this.token = token;
      localStorage.setItem('token', token);
    },

    clearToken() {
      this.token = '';
      localStorage.removeItem('token');
    },

    logout() {
      this.$reset();
      this.clearToken();
    },
  },

  // æŒä¹…åŒ–é…ç½®ï¼ˆå¦‚æœéœ€è¦ï¼‰
  persist: {
    key: 'user-store',
    paths: ['token'],
  },
});
```

## ğŸ“ å‘½åè§„èŒƒ

### 1. æ–‡ä»¶å‘½å

- ç»„ä»¶ï¼šå¤§é©¼å³° `UserCard.vue`
- ç»„åˆå¼å‡½æ•°ï¼šå°é©¼å³° `useUserList.ts`
- å·¥å…·å‡½æ•°ï¼šå°é©¼å³° `formatDate.ts`
- ç±»å‹å®šä¹‰ï¼šå°é©¼å³° `user.types.ts`
- å¸¸é‡ï¼šå¤§é©¼å³° `constants.ts`

### 2. å˜é‡å‘½å

```typescript
// åŸºæœ¬ç±»å‹
const count = ref(0);
const isLoading = ref(false);
const userName = ref('');

// æ•°ç»„
const userList = ref<UserInfo[]>([]);

// å¯¹è±¡
const userInfo = reactive({
  name: '',
  age: 0,
});

// å¸¸é‡
const MAX_COUNT = 100;
const API_TIMEOUT = 30000;
```

### 3. æ–¹æ³•å‘½å

```typescript
// è·å–æ•°æ®
const fetchUserList = async () => {};
const loadMore = async () => {};

// äº‹ä»¶å¤„ç†
const handleClick = () => {};
const onSubmit = () => {};

// çŠ¶æ€æ›´æ–°
const updateUserInfo = () => {};
const resetForm = () => {};
```

## ğŸ¨ æ ·å¼è§„èŒƒ

### 1. SCSSè§„èŒƒ

```scss
// ä½¿ç”¨scopedæ ·å¼
.container {
  // 1. å¸ƒå±€å±æ€§
  display: flex;
  justify-content: center;
  align-items: center;

  // 2. ç›’å­æ¨¡å‹
  width: 100%;
  height: 100%;
  padding: 20px;
  margin: 0 auto;

  // 3. æ–‡æœ¬
  font-size: 14px;
  line-height: 1.5;
  color: #333;

  // 4. èƒŒæ™¯
  background-color: #fff;

  // 5. è¾¹æ¡†
  border: 1px solid #e4e7ed;
  border-radius: 4px;

  // 6. å…¶ä»–
  cursor: pointer;
  transition: all 0.3s;

  // ä¼ªç±»
  &:hover {
    border-color: #409eff;
  }

  // å­å…ƒç´ 
  .item {
    flex: 1;

    // çŠ¶æ€ç±»
    &.active {
      color: #409eff;
    }
  }

  // åª’ä½“æŸ¥è¯¢
  @media (max-width: 768px) {
    flex-direction: column;
  }
}

// å…¨å±€æ ·å¼ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰
:global(.ant-btn) {
  font-weight: 500;
}
```

### 2. CSSå˜é‡ï¼ˆä¸»é¢˜è‰²ï¼‰

```css
:root {
  --primary-color: #409eff;
  --success-color: #67c23a;
  --warning-color: #e6a23c;
  --danger-color: #f56c6c;
  --text-primary: #303133;
  --text-regular: #606266;
  --border-color: #dcdfe6;
}
```

## ğŸ”§ å·¥å…·å‡½æ•°è§„èŒƒ

```typescript
// utils/http.ts - ç»Ÿä¸€è¯·æ±‚å°è£…
import axios from 'axios';

const http = axios.create({
  baseURL: import.meta.env.VITE_API_BASE_URL,
  timeout: 30000,
});

// è¯·æ±‚æ‹¦æˆªå™¨
http.interceptors.request.use((config) => {
  const token = localStorage.getItem('token');
  if (token) {
    config.headers.Authorization = `Bearer ${token}`;
  }
  return config;
});

// å“åº”æ‹¦æˆªå™¨
http.interceptors.response.use(
  (response) => {
    const { code, data, message } = response.data;

    if (code === 200) {
      return data;
    } else {
      return Promise.reject(new Error(message || 'è¯·æ±‚å¤±è´¥'));
    }
  },
  (error) => {
    // ç»Ÿä¸€é”™è¯¯å¤„ç†
    if (error.response?.status === 401) {
      // è·³è½¬ç™»å½•
    }
    return Promise.reject(error);
  }
);

export default http;

// utils/validate.ts - æ ¡éªŒå‡½æ•°
export function isEmail(email: string): boolean {
  const reg = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
  return reg.test(email);
}

export function isPhone(phone: string): boolean {
  const reg = /^1[3-9]\d{9}$/;
  return reg.test(phone);
}
```

## ğŸ“¦ ç¬¬ä¸‰æ–¹åº“ä½¿ç”¨è§„èŒƒ

### 1. Ant Design Vue

```vue
<template>
  <!-- ä½¿ç”¨a-å‰ç¼€ -->
  <a-button type="primary" @click="handleClick"> ç¡®å®š </a-button>

  <!-- è¡¨å•éªŒè¯ -->
  <a-form :model="form" :rules="rules">
    <a-form-item label="ç”¨æˆ·å" name="username">
      <a-input v-model:value="form.username" />
    </a-form-item>
  </a-form>
</template>

<script setup>
  // æŒ‰éœ€å¼•å…¥
  import { Button, message } from 'ant-design-vue';
</script>
```

## ğŸš€ æ€§èƒ½ä¼˜åŒ–

### 1. ç»„ä»¶æ‡’åŠ è½½

```typescript
// è·¯ç”±æ‡’åŠ è½½
const UserList = () => import('@/views/user/List.vue');

// æ¡ä»¶æ‡’åŠ è½½
import { defineAsyncComponent } from 'vue';
const HeavyComponent = defineAsyncComponent(() => import('./HeavyComponent.vue'));
```

### 2. å›¾ç‰‡æ‡’åŠ è½½

```vue
<template>
  <img v-lazy="imageUrl" />
</template>

<script setup>
  import { useLazyLoad } from '@/directives/lazyLoad';
</script>
```

### 3. é˜²æŠ–èŠ‚æµ

```typescript
import { debounce, throttle } from 'lodash-es';

const handleSearch = debounce(() => {
  fetchData();
}, 300);

const handleScroll = throttle(() => {
  // æ»šåŠ¨å¤„ç†
}, 200);
```

## ğŸ“ Gitæäº¤è§„èŒƒ

```
feat: æ–°å¢åŠŸèƒ½
fix: ä¿®å¤bug
docs: æ–‡æ¡£æ›´æ–°
style: ä»£ç æ ¼å¼è°ƒæ•´
refactor: ä»£ç é‡æ„
perf: æ€§èƒ½ä¼˜åŒ–
test: æµ‹è¯•ç›¸å…³
chore: æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨
```

## ğŸ” ä»£ç è´¨é‡

### 1. ESLinté…ç½®

```json
{
  "extends": [
    "@vue/eslint-config-typescript",
    "plugin:vue/vue3-essential",
    "eslint:recommended",
    "@typescript-eslint/recommended"
  ],
  "rules": {
    "vue/multi-word-component-names": "off",
    "@typescript-eslint/no-explicit-any": "warn",
    "no-console": ["warn", { "allow": ["warn", "error"] }]
  }
}
```

### 2. Prettieré…ç½®

```json
{
  "printWidth": 100,
  "tabWidth": 2,
  "useTabs": false,
  "semi": false,
  "singleQuote": true,
  "trailingComma": "es5",
  "bracketSpacing": true,
  "arrowParens": "always"
}
```

è¿™ä»½è§„èŒƒå¯ä»¥å¸®åŠ©å›¢é˜Ÿä¿æŒä»£ç é£æ ¼ä¸€è‡´ï¼Œæé«˜ä»£ç è´¨é‡å’Œå¯ç»´æŠ¤æ€§ã€‚æ ¹æ®é¡¹ç›®å®é™…æƒ…å†µå¯é€‚å½“è°ƒæ•´ã€‚
